---
title: 
    main: Dendrochronological dates confirm a Late Prehistoric population decline in the American Southwest derived from radiocarbon dates
    short: Dendrochronological and radiocarbon dates in the American Southwest
date: "`r format(Sys.Date(), '%B %d, %Y')`"
author:
  - Erick Robinson:
      email: erick.robinson@usu.edu
      institute: [USU]
      correspondence: true
  - R. Kyle Bocinsky:
      email: kbocinsky@crowcanyon.org
      institute: [CCAC,UM]
      correspondence: false
  - Darcy Bird:
      email: darcy.bird@wsu.edu
      institute: [WSU]
      correspondence: false
  - Jacob Freeman:
      email: jacob.freeman@usu.edu
      institute: [USU]
      correspondence: false
  - Robert L. Kelly:
      email: rlkelly@uwyo.edu 
      institute: [UW]
      correspondence: false
institute:
  - USU: Utah State University
  - CCAC: Crow Canyon Archaeological Center
  - UM: University of Montana
  - WSU: Washington State University
  - UW: University of Wyoming
abstract: >
  The northern American Southwest provides one of the most well-documented cases of human population growth and decline in the world. The geographic extent of this decline in North America is unknown due to the lack of high-resolution palaeodemographic data from regions across and beyond the greater Southwest, where archaeological radiocarbon data is often the only available proxy for investigating these palaeodemographic processes. Radiocarbon time series across and beyond the greater Southwest suggest widespread population collapses from AD 1300--1600. However, radiocarbon data have potential biases caused by variable radiocarbon sample preservation, sample collection, and the non-linearity of the radiocarbon calibration curve. In order to be confident in the wider trends seen in radiocarbon time series across and beyond the greater Southwest, here we focus on regions that have multiple palaeodemographic proxies and compare those proxies to radiocarbon time series. We develop a new method for time series analysis and comparison between dendrochronological data and radiocarbon data. Results confirm a multiple proxy decline in human populations across the Upland US Southwest, Central Mesa Verde, and Northern Rio Grande from AD 1300--1600. These results lend confidence to single proxy radiocarbon-based reconstructions of paleodemography outside the Southwest that suggest post-AD 1300 population declines in many parts of North America.
keywords:
    formatted:
      - dates-as-data
      - radiocarbon summed probability distributions
      - dendrochronology
      - palaeodemography
      - southwestern United States
doi: [DOI HERE]
journal: Preprint
documentclass: sa
bibliography: robinson2020_references.bib
# csl: "philosophical-transactions-of-the-royal-society-b.csl"
# csl: "journal-of-archaeological-science.csl"
csl: "apa.csl"
link-citations: true
output: 
    bookdown::pdf_document2:
      template: templates/template.tex
      latex_engine: lualatex
      fig_caption: yes
      toc: false
      # tables: true
      extra_dependencies:
        caption: ["labelfont={bf}"]
        # colortbl: null
      pandoc_args:
      - --lua-filter=templates/scholarly-metadata.lua
      - --lua-filter=templates/author-info-blocks.lua
      - --lua-filter=templates/pagebreak.lua
editor_options: 
  chunk_output_type: console
header-includes:
  \newcommand{\beginsupplement}{\setcounter{table}{0}  \renewcommand{\thetable}{S\arabic{table}} \setcounter{figure}{0}       \renewcommand{\thefigure}{S\arabic{figure}}}
---


```{r setup, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
  cache = FALSE,
  echo = FALSE,
  fig.align = "center",
  fig.path = here::here("analysis/figures/"),
  message = FALSE,
  warning = FALSE,
  collapse = TRUE,
  comment = "#>",
  dev = "pdf"
)
library(robinson2020)
library(ggplot2)
```

\newpage
<!-- \raggedright -->
# Introduction {-}
The spatial and temporal ubiquity of archaeological radiocarbon dates makes them an unprecedented proxy for human paleodemography. The past decade has witnessed a rapid increase in the use of archaeological radiocarbon time series to reconstruct prehistoric population growth and decline in various regions of the world [@Bevan2019; @Crema2016; @Goldberg2016; @Palmisano2019; @Peros2010; @Russell2009; @Shennan2013; @Wang2014; @Williams2012]. One of the first aggregations of radiocarbon dates for palaeodemographic analysis was by Berry [@Berry1982] in his study of population growth, decline and migration across the American Southwest. Radiocarbon time series were used as a complement to earlier periods that lacked robust dendrochronological records. Berry [-@Berry1982: 120] noted that they were “not even remotely related to population size”, but rather the “relative probability of occupation through time” and “the major trends in these charts (i.e., peaks and troughs) should provide a reliable indication of the direction of change”. Later, Rick [-@Rick1987: 56] more formally outlined the use of radiocarbon time series as a method for paleodemography by developing an ‘inference chain’ that detailed the various biases involved in their use and interpretation. Rick identified three biases: creation bias, preservation bias, and investigation bias [@Rick1987]. Over the past decade, as archaeologists have assembled and analysed large radiocarbon datasets from various regions of the world, there has been considerable focus on these biases, notably creation [@Crombe2014; @Freeman2018; @Naudinot2014] and preservation bias [@Peros2010; @Williams2012; @Bluhm2019; @Surovell2007; @Surovell2009], as well as bias caused by the radiocarbon calibration process [@Williams2012; @Armit2013; @Bamforth2012; @Contreras2014; @Michczynski2006; @Timpson2014]. Of the three biases Rick identified, investigation bias has been the most understudied thus far. Investigation bias occurs when investigators gather more radiocarbon samples for particular periods of time or specific geographic regions, which leads to periods or regions with more or less radiocarbon representation than the average time period or region. The biased selection of radiocarbon samples would then appear to be relative increases or decreases in population when they are merely artefacts of research history and fieldwork practice. Investigation bias has been understudied because for many regions of the world radiocarbon data are the only currently available proxy evidence enabling reconstructions of paleodemography in continuous time series spanning millennia. Assessing the impact of investigation bias on radiocarbon-based reconstructions of paleodemography requires comparison with other paleodemographic proxies.

The American Southwest provides one the best available case studies for assessing the role of investigation bias in radiocarbon-based reconstructions of paleodemography. It also has one of the most well-documented cases of population growth and decline in the world [@Bocinsky2016; @Hill2004; @Kohler2010b; @Robinson2019; @Freeman2018PNAS]. For almost a century, researchers have collected multiple proxies, such as dendrochronological records, settlement size records, and ceramic seriation records to address the magnitude of this population growth and decline. However, a critical knowledge gap still exists for the exact scale of population decline across and beyond the Southwest [@Cameron2010; @Boyer2010]. This gap is because the less intensively researched regions lack multiple proxies for robust reconstructions of paleodemography. In these regions, radiocarbon data are the only available proxy time series for reconstructing paleodemography. Over the past six years, we have collected all available radiocarbon data across and beyond the Southwest [@Robinson2019]. Initial analyses of this new radiocarbon dataset have revealed extensive population decline from AD 1300--1600 across and beyond the Southwest [@Robinson2019; @Freeman2018PNAS]. Therefore, the geographic extent of Late Prehistoric population decline could be much broader than previously expected.

The potential importance of this widespread population decline for research on Late Prehistoric archaeology of the American West requires comparison of the sensitivity of lower-resolution radiocarbon data against other higher-resolution palaeodemographic proxies. In the most well-documented regions (such as the northern American Southwest) we expect radiocarbon records to reflect the highest amount of investigation bias, as researchers have the option of selecting from a suite of other higher-resolution proxies, including dendrochronology and ceramic seriation. Investigation bias can create an artificial ‘edge effect’ spuriously appearing as a decrease in population. Here we develop a new method for arraying dendrochronological records as time series for comparison against radiocarbon time series. We focus on the broader region of the Upland US Southwest (UUSW) for which there is a robust dendrochronological record [@Bocinsky2016].

We also focus on the more concentrated and intensively investigated Central Mesa Verde (CMV) and Northern Rio Grande (NRG) regions of the UUSW (Figure \@ref(fig:Figure1)), for which multiproxy palaeodemographic reconstructions were produced by the Village Ecodynamics Project (VEP) [@Ortman2016; @Schwindt2016]. The VEP is an interdisciplinary, multi-method research initiative aimed at better understanding demography of ancestral Pueblo farmers and human-environment interaction across the UUSW. As part of the project, VEP researchers cataloged data on all known archaeological habitation sites within a 4,600-km2 area in the CMV [@Schwindt2016] and a 6,900-km2 area in the NRG [@Ortman2016], to which most of the CMV population migrated during the thirteenth century AD [@Ortman2016]. They integrated data including pitstructure and room count estimates, the presence of diagnostic architectural features, surface ceramic tallies, surveyor assessments, and limited dendrochronological data in an empirical Bayesian framework to develop population estimates for each region resolved to periods ranging from 20 to 125 years in length [@Ortman2016; @Schwindt2016]. The VEP estimates are the highest quality regional palaeodemographic reconstructions currently available in the UUSW, and are completely independent of the radiocarbon records for the region. They are therefore useful in exploring the impact of investigation bias in the radiocarbon record.

(ref:fig1) The UUSW as defined in this study (region with black border). The white dashed area represents the UUSW as defined by @Bocinsky2016. VEP study areas are white boxes. CMV: Central Mesa Verde; NRG: Northern Rio Grande.

```{r Figure1, fig.height=6.5, fig.width=6.5, out.width = '50%', fig.cap="(ref:fig1)"}
# A nice projection of the Four Corners states to use for mapping
four_corners_lcc_proj <-
  robinson2020::four_corners_lcc_proj

# The Four Corners states in four_corners_lcc_proj
four_corners_states <-
  robinson2020::four_corners_states

# The UUSW as defined in Bocinsky et al. 2016
uusw_boundary <- robinson2020::uusw_boundary

# The UUSW study area for this analysis
uusw_counties <-
  robinson2020::uusw_counties

# The VEP study areas
vep_study_areas <-
  robinson2020::vep_study_areas

# Truncate calendar dates to AD 200 - 1800
trunc_dates <- c(1750, 150)

theme_map <- function(base_size = 6.5,
                      base_family = "") {
  theme_bw(
    base_size = base_size,
    base_family = base_family
  ) %+replace%
    theme(
      axis.line = element_blank(),
      axis.text = element_blank(),
      axis.ticks = element_blank(),
      axis.title = element_blank(),
      panel.background = element_blank(),
      panel.border = element_blank(),
      panel.grid = element_blank(),
      panel.grid.major = element_line(colour = "transparent"),
      panel.grid.minor = element_line(colour = "transparent"),
      legend.key = element_blank(),
      legend.position = "top",
      plot.background = element_blank(),
      plot.margin = margin(t = 0, r = 0, b = 0, l = 0, unit = "npc")
    )
}

ggplot() +
  geom_sf(data = four_corners_states) +
  # geom_raster(
  #   data = robinson2020::swus_hillshade_500m,
  #   mapping = aes(
  #     x = x,
  #     y = y,
  #     alpha = ID
  #   ),
  #   na.rm = TRUE
  # ) +
  scale_alpha(
    range = c(0.8, 0),
    na.value = 0,
    limits = c(0, 255),
    guide = "none"
  ) +
  geom_sf(
    data = four_corners_states,
    fill = NA
  ) +
  geom_sf(
    data = uusw_counties %>%
      sf::st_union() %>%
      rmapshaper::ms_filter_islands(),
    fill = NA,
    color = "black"
  ) +
  geom_sf(
    data = uusw_boundary,
    fill = NA,
    linetype = 2,
    color = "white"
  ) +
  geom_sf(
    data = vep_study_areas,
    fill = NA,
    color = "white",
    size = 1
  ) +
  geom_sf_text(
    data = vep_study_areas,
    aes(label = `Study Area`),
    size = 3
  ) +
  theme_map(16)
```

We expect that substantial investigation bias is present in radiocarbon records if those records substantially diverge from the dendrochronological and multiproxy reconstructions. If the lower-resolution radiocarbon records reveal similar trends to the two other records, we expect investigation bias does not substantially impact the ability of radiocarbon records to be used as relative measures of the directionality of population change through time. This would, in turn, lend more confidence to radiocarbon records across the American West that reveal extensive post AD 1300 population declines but lack other palaeodemographic proxies.

# Methods {-}
Here we compare two large collections of radiocarbon and tree-ring dates drawn from the UUSW. After harmonizing those datasets with one another and calibrating the radiocarbon dates, we calculate binned summed probability distributions across the UUSW, CMV, and NRG. The radiocarbon dates we analyse here are drawn from the National Science Foundation supported project, “Populating a Radiocarbon Database for North America,” which have been uploaded to the Canadian Archaeological Radiocarbon Database (CARD; https://www.canadianarchaeology.ca). Tree-ring data are those presented by @Bocinsky2016. Both datasets are available on the Digital Archaeological Record (see [Data Accessibility]).

## Study Area {-}
The UUSW was geographically defined by @Bocinsky2016 as the region between 105--113°W and 32--38°N. Here, we refine that definition in two ways. First, because location data for our radiocarbon database are only resolved to the county level for most sites [@Robinson2019], we define our study region to include all counties whose geographic centroids fall within the region from @Bocinsky2016. Second, because of the generally poor tree-ring date record in the Sonoran Desert, we exclude the Phoenix and Tucson basins by dropping Maricopa, Pinal, and Pima counties in Arizona. Figure \@ref(fig:Figure1) shows the original UUSW from @Bocinsky2016 and revised study area used in this analysis, as well as the two VEP study areas.

## Period of Interest {-}
Here, we focus our analyses on the period for which data are most abundant: 1750--150 BP, or AD 200--1800. This period includes the periods of the VEP population estimates for the CMV (AD 600--1280) and NRG (AD 900--1760), and extends 400 years earlier than the CMV estimates to allow us to assess trends in the radiocarbon record leading up to the VEP reconstructions, and to control for edge effects. While the VEP demographic estimates are for ancestral Pueblo populations only, it is likely that the tree-ring records include samples from Spanish colonial contexts after AD 1600 or so.

## Datasets {-}
```{r prepare-radiocarbon-data}
# Read in the radiocarbon database
# Filter the 2-sigma calibrated ranges to the trunc_dates range
if (!file.exists(
  here::here("analysis/data/derived_data/radiocarbon_data.csv")
)) {
  readr::read_csv(
    here::here("analysis/data/raw_data/robinson_et_al_2020_radiocarbon.csv")
  ) %>%
    dplyr::mutate(
      Type = "Radiocarbon",
      Site_ID = Site_ID %>% stringr::str_c("Radiocarbon - ", .)
    ) %>%
    dplyr::select(
      Type,
      SiteID = Site_ID,
      Site_Number,
      County,
      Lab_Number,
      Date_BP,
      SD
    ) %>%
    # retain dates whose calibrated 95% probability mass overlaps trunc_dates
    dplyr::filter(
      rcarbon::calibrate(
        x = Date_BP,
        errors = SD,
        verbose = FALSE
      ) %>%
        rcarbon:::hpdi(credMass = 0.95) %>%
        purrr::map_lgl(function(x) {
          startdate <- max(x[, "startCalBP"])
          enddate <- min(x[, "endCalBP"])
          startdate > trunc_dates[[2]] && enddate <= trunc_dates[[1]]
        })
    ) %>%
    # Write the output to a new file (csv)
    readr::write_csv(
      here::here("analysis/data/derived_data/radiocarbon_data.csv")
    )
}

radiocarbon_data <-
  readr::read_csv(
    here::here("analysis/data/derived_data/radiocarbon_data.csv")
  )
```

We cleaned the radiocarbon database by first removing all non-archaeological dates. To ensure our data are reasonably precise, we removed all radiocarbon dates with 1σ errors greater than 300 years and more than 25% of the uncalibrated age. We removed dates with duplicate lab numbers whose radiocarbon ages, 1σ errors, or county information did not match. We then trimmed these data to counties within the UUSW. We retained radiocarbon dates that likely derive from our period of interest by first calibrating all of the dates, then retaining dates whose 95% calibrated probability masses overlapped 1750--150 BP.

```{r prepare-treering-data}
# Read in the Bocinsky et al. 2016 tree ring data
# https://doi.org/10.6067/XCV82J6D7B

if (!file.exists(
  here::here("analysis/data/derived_data/dendro_data.csv")
)) {
  readr::read_csv(
    here::here("analysis/data/raw_data/BOCINSKY_ET_AL_2015_TREE_RINGS.csv")
  ) %>%
    # Convert to spatial object
    sf::st_as_sf(
      coords = c("LON", "LAT"),
      crs = 4326
    ) %>%
    sf::st_transform(four_corners_lcc_proj) %>%
    # Convert dates to BP
    dplyr::mutate(
      Date_BP = 1950 - Outer_Date_AD,
      Type = ifelse(C_Level %in% c(2, 3),
        "Cutting or Near-cutting",
        "Non-cutting"
      )
    ) %>%
    # drop C_Level
    dplyr::select(
      Seq_Number,
      Site_Number,
      Lab_Number,
      Type,
      Date_BP
    ) %>%
    dplyr::rename(SiteID = Seq_Number) %>%
    sf::st_intersection(uusw_counties) %>%
    sf::st_drop_geometry() %>%
    dplyr::mutate(
      Type = Type %>% stringr::str_c("Dendro - ", .),
      SiteID = SiteID %>% stringr::str_c("Dendro - ", .),
      SD = 0
    ) %>%
    dplyr::filter(Type == "Dendro - Cutting or Near-cutting") %>%
    dplyr::mutate(Type = "Tree-ring") %>%
    dplyr::select(
      Type,
      SiteID,
      Site_Number,
      County,
      Lab_Number,
      Date_BP,
      SD
    ) %>%
    # Get only raw dates within trunc_dates
    dplyr::filter(
      Date_BP > trunc_dates[[2]],
      Date_BP <= trunc_dates[[1]]
    ) %>%
    # Write the output to a new file (csv)
    readr::write_csv(
      here::here("analysis/data/derived_data/dendro_data.csv")
    )
}

dendro_data <-
  readr::read_csv(
    here::here("analysis/data/derived_data/dendro_data.csv")
  )
```

We draw on the tree-ring date database presented by @Bocinsky2016. These data were compiled by Tim Kohler and Rebecca Higgins from many contributors, and the vast majority of dates were produced by the Laboratory of Tree Ring Research at the University of Arizona. The original dataset contained 32,863 cutting, near-cutting, and non-cutting dates from across the US Southwest. Here, we only use the dates that are most likely to be accurate — cutting dates (‘B’, ‘G’, ‘L’, ‘c’, or ‘r’ dates, with or without a ‘+’) for which we know the year the tree died, and near-cutting dates (‘v’ or ‘v+’ dates) which are likely within 0--3 years of the true date of the outermost ring. The @Bocinsky2016 data contain site locations; for this analysis, we first spatially cropped the database to our study area, and then translated those locations to the county level. We converted the original date determinations to BP to match calibrated radiocarbon year conventions, and retained dates within 1750--150 BP.

Finally, due to much of the radiocarbon data only being resolved to the county level, we had to approximate inclusion in the VEP, CMV and NRG study areas. The CMV study area conforms well to Montezuma county, Colorado; the NRG overlaps with Los Alamos, Rio Arriba, Sandoval, Santa Fe, and Taos counties in New Mexico. In the analyses below, dates were included as “within” each study area if they derive from those respective counties.

```{r all-data}
all_data <- list(
  Radiocarbon = radiocarbon_data,
  `Tree-ring` = dendro_data
) %>%
  purrr::map(~ dplyr::mutate(.x,
    `Study Area` = ifelse(County == "Montezuma, CO",
      "CMV",
      NA
    ),
    `Study Area` = ifelse(County %in% c(
      "Los Alamos, NM",
      "Rio Arriba, NM",
      "Sandoval, NM",
      "Santa Fe, NM",
      "Taos, NM"
    ),
    "NRG",
    `Study Area`
    )
  ))
```

Our final dataset includes `r nrow(all_data$Radiocarbon) %>% format(big.mark = ',')` radiocarbon dates from `r all_data$Radiocarbon$SiteID %>% unique() %>% length %>% format(big.mark = ',')` unique sites, dating from `r max(all_data$Radiocarbon$Date_BP)`--`r min(all_data$Radiocarbon$Date_BP)` BP (uncalibrated; `r -1 * (1950 - max(all_data$Radiocarbon$Date_BP)) - 1` BC--`r 1950 - min(all_data$Radiocarbon$Date_BP)` AD) and `r nrow(all_data[['Tree-ring']]) %>% format(big.mark = ',')` tree-ring dates from `r all_data[["Tree-ring"]]$SiteID %>% unique() %>% length %>% format(big.mark = ',')` unique sites, dating from `r max(all_data[['Tree-ring']]$Date_BP)`--`r min(all_data[['Tree-ring']]$Date_BP)` BP (`r 1950 - max(all_data[['Tree-ring']]$Date_BP)`--`r 1950 - min(all_data[['Tree-ring']]$Date_BP)` AD). Table \@ref(tab:Table1) presents the counts of dates and sites of each date type in the CMV and NRG study areas.

```{r Table1}
all_data %>%
  dplyr::bind_rows() %>%
  dplyr::bind_rows(all_data %>%
    dplyr::bind_rows() %>%
    dplyr::mutate(`Study Area` = "UUSW Total")) %>%
  dplyr::filter(!is.na(`Study Area`)) %>%
  dplyr::mutate(`Study Area` = factor(`Study Area`,
    levels = c(
      "UUSW Total",
      "CMV",
      "NRG"
    )
  )) %>%
  dplyr::group_by(Type, SiteID, `Study Area`) %>%
  dplyr::summarise(Dates = dplyr::n()) %>%
  dplyr::group_by(Type, `Study Area`) %>%
  dplyr::summarise(
    Dates = sum(Dates),
    Sites = dplyr::n()
  ) %>%
  tidyr::pivot_wider(names_from = Type, values_from = Dates:Sites) %>%
  dplyr::select(`Study Area`, Dates_Radiocarbon, Sites_Radiocarbon, `Dates_Tree-ring`, `Sites_Tree-ring`) %>%
  knitr::kable(
    caption = "Counts of radiocarbon and tree-ring dates and sites in this study.",
    format = "latex",
    booktabs = TRUE,
    format.args = list(big.mark = ","),
    col.names = c("Study Area", "Dates", "Sites", "Dates", "Sites")
  ) %>%
  kableExtra::add_header_above(c(" " = 1, "Radiocarbon" = 2, "Tree-ring" = 2))
```


